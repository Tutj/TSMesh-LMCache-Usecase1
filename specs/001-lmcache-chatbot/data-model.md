# Data Model for Multi-Turn Conversational AI

**Date**: 2026-02-06
**Status**: Draft

This document defines the key data entities for the project, based on the feature specification.

## 1. Conversation

Represents a full interaction sequence between a user and the chatbot.

- **`conversation_id`**: `string` (UUID) - Unique identifier for the conversation.
- **`created_at`**: `datetime` - Timestamp when the conversation was initiated.
- **`turns`**: `List[Turn]` - An ordered list of turns that make up the conversation.
- **`metadata`**: `Dict` - Any additional metadata associated with the conversation (e.g., user ID, session ID).

## 2. Turn

A single user request and the corresponding chatbot response within a conversation.

- **`turn_id`**: `string` (UUID) - Unique identifier for the turn.
- **`conversation_id`**: `string` (UUID) - The ID of the conversation this turn belongs to.
- **`user_prompt`**: `string` - The input text from the user.
- **`chatbot_response`**: `string` - The response generated by the chatbot.
- **`agent_name`**: `string` - The name of the agent that handled the request (e.g., "Sales Agent").
- **`created_at`**: `datetime` - Timestamp when the turn was created.
- **`metrics`**: `Dict` - Performance metrics for this turn (e.g., TTFT, latency, cache_hit).

## 3. Agent

A specialized service or model responsible for handling a specific domain of queries. This is more of a logical entity in the `langgraph` model, not a data entity to be stored.

- **`name`**: `string` - The unique name of the agent (e.g., "Sales Agent").
- **`description`**: `string` - A description of the agent's capabilities.
- **`prompt_template`**: `string` - The structured prompt template used by the agent, including the common "Manual" prefix.

## 4. Router

A component that analyzes an incoming user prompt and determines the most appropriate Agent to handle it. This is a logical component in the `langgraph` graph.

## 5. Cache Entry

The stored KV cache state associated with a specific prompt prefix. This entity is managed internally by `lmcache` and is not directly exposed through the API.
